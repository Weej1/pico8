pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
local time_t=0
local actors={}
local plyr

function project(x,y)
	return 64+x,64-y
end

function make_plyr(x,y)
	local a={
		x=x,
		y=y,
		spr=6+flr(rnd(3)),
		dx=rnd()>0.5 and 1 or -1,
		update=function(self)
			return true
		end,
		draw=function(self)
			local x,y=project(self.x,self.y)
			line(x,y+7,x+4,y+7,1)
			palt(14,true)
			spr(10,x,y)
		end
	}	
	return add(actors,a)
end

local next_car_t=0
function make_car(y)
	local right=rnd()>0.5
	local a={
		x=right and 64 or -64,
		y=y,
		spr=6+flr(rnd(3)),
		dx=right and -1 or 1,
		update=function(self)
			self.x+=self.dx
			if self.x<-64 or self.x>64 then
				return false
			end
			return true
		end,
		draw=function(self)
			palt(14,true)
			palt(0,false)
			local x,y=project(self.x,self.y)
			spr(self.spr,x,y,1,1,right)
			palt()
		end
	}	
	return add(actors,a)
end

function _init()
	plyr=make_plyr(0,0)
end

function _update60()
	time_t+=1
	
	local dx,dy=0,0
 if(btn(0)) dx=-0.85
 if(btn(1)) dx=0.85
 if(btn(2)) dy=0.85
 if(btn(3)) dy=-0.85
 
 plyr.x+=dx
 plyr.y+=dy
 
 for _,a in pairs(actors) do
 	if not a:update() then
 		del(actors,a)
 	end
 end
 
 if next_car_t<time_t then
 	make_car(-24+rnd(32))
 	next_car_t=time_t+49+rnd(32)
 end
end

function _draw()
	cls(0)
	map(0,0,0,24,16,16)
	
	for _,a in pairs(actors) do
		a:draw()
	end
end

__gfx__
000000007666666677777777666666666666666766666666eeeeeeeeeeeeeeeeeeeeeeee77767776eeeeeeeeeeeeeeee05eeeeee000000000000000000000000
000000007666666666666666666666666666666766666666eaaceeeee18ceeeeddddceee66666666eeeeeeeeeeeeeeee4eeeeeee000000000000000000000000
007007007666666666666666666666666666666766666666a77ccaae11c7c11eddddcdde66666666eeaeeeeeeeaeeeeeeeeeeeee000000000000000000000000
00077000766666666666666666666666666666676666666679ddc77e1dd1711e55551dde6666666622f22eee22f222fe550eeeee000000000000000000000000
0007700076666666666666666666666666666667666666669999999eddddddde5555555e6666666642224eee4222eeeee0eeeeee000000000000000000000000
0070070076666666666666666666666666666667666666669099095ed0dd0d5e0055005e66666666fdddfeeefdddeeeeeeeeeeee000000000000000000000000
0000000076666666666666666666666666666667666666661111111e1111111e0011001e66666666ed5deeeeed5deeee5bb5eeee000000000000000000000000
000000007666666666666666777777776666666766666666eeeeeeeeeeeeeeeeeeeeeeee66666666ededeeeeededeeee333deeee000000000000000000000000
33333333777777776666666600000000000000000000006600000000eeeeeeee5555555511111111eeeeeeee0000000000000000000000000000000000000000
33333333666666666777777600000000000000000000006600000000eeeeeeee9999999955555555eeeeeeee0000000000000000000000000000000000000000
33333333677777766666666600000000000000006660006000000000aaaaaaae5555555555555555ee1eeeee0000000000000000000000000000000000000000
333333336666666667777776000000000000b00066666606666660007aaaaa7a555555555555555511f11eee0000000000000000000000000000000000000000
33333333677777766666666600000000000b5b0000000060006660001919191a5555555555555555c11aceee0000000000000000000000000000000000000000
33333333666666666777777600000000000353000000066000000000999999995555555555555555f111feee0000000000000000000000000000000000000000
333333336777777666666666000000000000b0000000066000000000009990045555555599999999e1e1eeee0000000000000000000000000000000000000000
333333336666666677777777000000000000b0000000000000000000001110011111111155555555e1e1eeee0000000000000000000000000000000000000000
000000000000000000000000000000000000b0000660000006600000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000bb000000ccc00000bbb000666000066000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000cb7b0000b33000000b7b00000b7b000000660600000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000ccb5bbbbb333000000b5b00000b5b000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000dcb3b3333b30000000b3b00000b3b000000060660000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000dd33300003000000003b300000ccc000006600006660000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000333000000000000000b000000dcd000066000000660000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000b0000000d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000003b300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1919191919191919191919191919191900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202110202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0909110909090909090909090909090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202110202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0909110909090909090909090909090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1818181818181818181818181818181800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
