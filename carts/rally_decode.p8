pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
local qmap="9400088224f60008830008243484102024850008ec0008822400082434861020248300088224e8000824348e102082243484102024e4000824349010203486102024e2000824349a10208324de000824349c10208324dc00082434a2102024d800082434a4102024d600082434a6102024d5002434a8102024d40034ac102024d00008ae102024ce0008249610203497102024cd00822495102082243497102024cc0082248e102024000882248300082434971020cc0024348d10202483000885000824349710cc00348d1020248d000883243493102024c800088e1082248e000883243493102024c700248e108224910008243493102024c600248e1024930008243493102024c500248e109700082434911020c500348d102098000824349110c5008d1020249900082434901024c4008d1082249a000824348f1024c4008d1082249d00088e10c5008d10249f00348d10c5008d10a00024348c1024c4008d10a00008248c102024c3008d10a100088d1020c3008d10a100088e10c3008d10249f0008248e1024c2008d10249f0082248e1024c2008d10a00082248e10c3008d109f000824348d1020c3008d109c00088324348d102024c3008d109b00088324348d102024c4008d1024970008243491102024c5008d1024960008243492108224c5008d1094000883243493108224c5008d10930008832434941024c6008d10248f000824349910c7008d10248e00082434991020c7008d108e0008243499102024c7008d108e00243499102024c8008d108e003499102024c9008d108d00089910208224c9008d10248b000824941020832400088224c9008d1082248a000824941020832400088224c9008d1082248b000895102082243484102024c6008d1020248c00349510203486102024c500348d10208c0024349d102024c400248e108c000824349d102024c300248e10248c000824349d1020c300248e10248d0008249e10c300088e108f00089e1024c300348d109000349d102024c20024348c10248f0024349d102024c10008248c1020248e0008249e102024c100088d10208f00089f1020c100088e109000349f10c00008248e10248f0024348e1020348e1024bf0008248e1020248e000824348c102082248e102024bf00088f1020248e0008243486102083248300088f10208324870008870008870008a500348f1020248e0008243484102083248500348f10208324850008822485000882248500088224a40024348f102091000882248a00243493102082243484102082243484102082243484102024a1000824348f109200088b0008243493102034861020348610203486102024a1000824348e10249e00082434ab102024a10008248e1020249e000824ac102024a100088f1020249e0008af1020249f00348f1020249e0034af1020249e0024348f10209e002434af1020249d000824348f109e00082434af1020249d000824348e10249e00082434af10209e0008248e1082249e00082434af109f00088e108224a10008832434aa10249f00348d102024a20008832434a91020249e0024348d102024a4000824348610203486102034861020349110209e000824348d102024a40008243484102082243484102082243484102082243491109f000824348d102024a6000882248500088224850008822485000824348e10249f0082248e102024a60008870008870008870008248e10249f00822491102024bc00088e10a000082492102024bc00348d10a1000893102024830008b70024348c1024a100349310202400088224b5000824348c102024a0002434991020248300089500089100088300082434901020a000082434991020240008822493000882248f00088224000824349210a1000824349f1020248d00082434841020248300088500082434991024a1000824349f1020248b00082434861020240008822483000824349a1024a4000824349d10202489000824348e10208224349b10a6000824349d10202488002434901020349b1020a7000824349d1020880034ad102024a8000824349d10870008ad102024aa000824349c102485000824ac102024ac000824349b102485000824ab102024b000088224000824349410870008a610208324b400088300082434921020880034a410208324ba000824349010202488002434a2102024be000824348e1020248900082434a0102024c20008822400082434861020248b00082434901020348610202400088224c600088300082434841020248d000824348e102082243484102024830008ce00088224930008822400082434861020248300088224d60008950008830008243484102024850008f400088224fe0008ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00ff00c9002a1709140710050b0407050507040a030d0310031303150318041b051f072209250b290f2c142e182f232f27302c2f302e342c332832262f242b24272423241f221d1f1b1c171c141d131b1118151619141b101a0c"

local colors={3,4,9}
cls(11)
local i=1
local read_nibles=function(n)
	local v=tonum("0x"..sub(qmap,i,i+n-1))
	i+=n
	return v
end
local idx=0
while idx<128*128 do
	-- peek data
	local k,q=read_nibles(2)
	-- rle or value?
	if band(0x80,k)>0 then
	 -- run length
		k=band(0x7f,k)
		--[[
		color(7)
		print(k)
		flip()
		]]
		q=read_nibles(2)
	else
		k,q=1,k
	end
	for j=1,k do
		-- coordinates
		local x,y=idx%128,flr(idx/128)
		pset(x,y,q+1)
		idx+=1
	end
	if(idx%128==0)flip()
end
for k=1,read_nibles(2) do
	local x,y=read_nibles(2),read_nibles(2)
	circfill(2*x,2*y,2,8)
end

